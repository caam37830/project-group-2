\documentclass{article}
\usepackage{verbatim}
\usepackage{amsmath}
\usepackage[margin=1in,left=1.5in,includefoot]{geometry}
\usepackage{graphicx}
\usepackage{systeme}
\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{biblatex}
\usepackage{float}
\usepackage{hyperref}
\usepackage{placeins}
\usepackage{fancyhdr}
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyfoot[R]{ \thepage\ }
\usepackage[utf8]{inputenc}

% Default fixed font does not support bold face
\DeclareFixedFont{\ttb}{T1}{txtt}{bx}{n}{12} % for bold
\DeclareFixedFont{\ttm}{T1}{txtt}{m}{n}{12}  % for normal

% Custom colors
\usepackage{color}
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{rgb}{0.6,0,0}
\definecolor{deepgreen}{rgb}{0,0.5,0}

\begin{document}


\begin{titlepage}
  \begin{center}

    \huge
    \textbf{Final Report}\\
   % \vfill
    \vspace{4.5cm}
    \LARGE
    Group 2: Yujin Liu, Helen Jin, Jiangmeng Li\\
    \vspace{4.5cm}
    \Large
    CAAM37830\\
    \vspace{1cm}
    University of Chicago\\
    \vspace{1cm}
    December 9, 2020

  \end{center}

\end{titlepage}

\section{Abstract}
In this report, we investigated how the infectious disease spread throughout the population based on the susceptible-infected-recovered (SIR) epidemic model. We first ran the simulation with both the discrete agent-based and the continuous ODE models. We then proposed and implemented three variations of the model. In the first modification, we aim to understand how the mask use will change the way infectious disease spread, and how the adoption of the masks with different effectiveness influences number of hospitalizations and deaths. Secondly, we used some default parameters to fit the Covid data from Hubei, China to our continuous ODE model with a close attention to the removed and infected rate. Lastly, we also created a visualization of the interactive heat map, interactive time series plot of the confirmed and death for different states. Apart from these variations of the model, we also added the  a 2-dimensional spatial component to both the discrete agent-based and the continuous ODE models where population is confined in a box and observe how different initial location conditions change the spread of the disease.

\section{Introduction}
The susceptible-infected-removed (SIR) model is one of the compartmental models that simplify the mathematical modeling to the spread of infectious disease, where the time dependent variables $S$, $I$, $R$ each represent the following populations:

$S$(susceptible): number of individuals who are not infected but could become infected

$I$(infected): number of individuals who are already infected and can spread disease

$R$(removed): number of individuals who are either recovered and immune or have died

Additionally, $s$, $i$, $r$ are used to represent the proportion of susceptible, infected and removed individuals among the population. Note that this model assumes the susceptible population $S$ decreases monotonically towards 0, and the population size is fixed, and the duration of infectivity is same as length of the disease.

There are two parameters $b$ and $k$ in the model, where $b$ indicates the number of interactions each day that could spread the disease (per individual) and $k$ indicates the fraction of the infectious population which recovers each day. The model consists of the following system of the nonlinear ordinary differential equations, where $t$ is time:

$$\frac{ds}{dt} = -b * s(t) * i(t)$$

$$\frac{dr}{dt} = k * i(t)$$

$$\frac{di}{dt} = b * s(t) * i(t) - k * i(t)$$


\section{Spatial Model and Variations}
\subsection{spatial agent based model}
Firstly, we briefly introduce the agent based model in midterm checkpoint. We assumed that each person contact b people every day. For each infected person, the recover rate is k. We simulated the process of interaction for population and found the region in which all people would be infected. We also attained the phase transition boundary $b = 10*k - 3$.\\

Now we would like to introduce the spatial agent based model. This is how we implement the model. We introduce another Person() class with the pos attribute. For each individual, it will move and interact with other individuals according to movpos function. We also define the resetcorner and resetcenter functions to set the position of an individual so that we can implement the simulation function in different occasions.\\

This is the simulated model as we start all the individuals randomly. we set $k = 0.6$, $q = 0.08$, $p = 0.5$. We can see all the people will  finally be infected which is reasonable since each individual will move with a large step size and radius q(0.08) is large enough compared with a population size of 20000. We can observe that all susceptible people eventually get infected very quickly.\\

In this part, we would like to explore the relationship between the total infected individuals and p as infected people initially located at the center of the confined region. We choose the parameter b = 0.5, k = 2 from the phase transition boundary.
We can see that as p increases, the percentage of total infection increases until a peak value of around 0.8 is reached at p = 0.1. Then, it remains stable as p changes from 0.1 to 0.2. As p increases from 0.2, the percentage of total infection decreases, especially when $p > 0.7$.


The result of the plot matches our expectation. As p is small ($p=0.01$), infected individual barely moves, only a small portion of susceptible people will get infected. People who are infected initially will be recovered and the total percentage of infection is small.


As $ 0.1<p<0.4 $, all the infected people will move around and contact most of susceptible people. The total percentage of infected people will be large. However, we choose the b,k from transition boundary and we can observe not all the people will finally be infected.


As p is large, some of the infected people may stay at the original position because the step size is large. Thus, the total percentage of infected people will decrease. As p is extremely large, all the infected people will stay at the center. They can only infect the susceptible people around them initially. Only small percentage of population will finally be infected.\\


Now, we would like to discuss what will happen if all the people move from the corner or randomly spread. We choose the parameter p = 0.05
We can see that the percentage of total infection will attain the maximum if all the infected people start from the random position in the grid. It will reach minimum if all the infected people start from a single corner of the grid. This is reasonable. As all the infected individuals move from a random position, they will frequently interact with different people among the population and it will be stable with most of people quickly get infected.
However, if all the infected people start from a single corner, they will not move too far away from that corner if the step is small. Thus, they will only contact with a small amount of susceptible people and all the infected people will quickly be recovered. Therefore, we can conclude that total percentage of the infected people will be small if they start from a single corner and the step size is small.\\
Now we consider the case that all people start at the center, with a small step size p = 0.05. Since infected people will have more contact with others compared to the situation where they start at the corner, the total percentage of infected people will be larger. However, the step size is small and all the infected people will also quickly be recovered and the total percentage of infected individuals will be smaller than the case that all the infected people are random spreaded out in the grid.

\subsection{Spatial PDE Model}
Firstly , we briefly introduce the ode model in the midterm checkpoint. The implementation is quite straightforward. The inputs for the derivative are three variables s,i,r and a function for obtaining derivative. Then we ran the ode simulation with the $solve_ivp$ function. The result is reasonable and we almost have the same transition phase boundary as what we explored in agent based model. In the following part, we use the parameter b =1 and k = 0.4. Not all the people will be susceptible in this case.

Now we would like to explain how we implemented the spatial pde model. We have several functions for generating the desired distribution of population. generatesum2 is the function for generating the population with initial infected people randomly spreaded out in the grid. generatesum2center is the function for setting the infected individuals at center intially while generatesum2corner is the one setting the infected individuals at corner. We combine the s,i,r vector together as input for derivative function, and then calculate the derivative accoring to the relationship:\\
$$\partial s(x,t)/\partial t = - b*s(x,t)*i(x,t) + p *L  s(x,t)$$
As for i(x,t) and r(x,t), similar relationship can be established. Since we have the function for obtaining derivative, we can simulate the pde process. The following is the result.

The plot is reasonable. We choose the parameter b=1 and k = 0.4. We can observe the case that not all the individuals will finally be infected. We choose an appropriate diffusion term p = 1 so that all the susceptible in the grids can be potentially infected by the initially infected group located at center.

Now, we analyze how total percentage of infected people i changes with p. We choose the p in list [1,2,3,4,5,10,20,30,40,50] .We can see that as p is increasing, the total infected people will increase. The increment is not large.\\
 We can conclude that the percentage of total infection will be large if diffusion term is large since all the people will interact with individuals located in different positions frequently. The population will reach a stable state quickly. \\
 We also find that the increment is not large as p is increasing. This is because we have the diffusion term p > =1 which guarantees the condition that the infected people can be spread out in the grid before most of the infected people in population are recovered.
 Thus,as p is increasing, we can observe the increment while it is not large.\\

 In this part, we try to understand what will happen if we place infected people at different locations initially. As p = 20, the total infected percentage of population are 0.8926 ,0.88 ,0.86 as initial infected people are randomly spread out, located from center, located in a corner respectively. The result is reasonable. The total infected people will reach its maximum if people infected initially are distributed randomly in the grid because there is a chance that infected people may contact all the susceptible people in different positions before all the they recoer. However, we control the relationship between b and k to ensure that not all the people will finally be infected.
 As for the case that all the infected people were initially located at center, we can see that the total percentage of infected people will be close to the first case since the diffusion term is large  and most of infected people will have a chance to contact susceptible people before they recover. As for the case that all infected people were located at a corner initially, the total percentage of infection will be smaller because the infected people will contact less people due to the starting position before they are recovered.


 \section{Covid-19 fit}
 In this variation, we will fit the Covid-19 dataset in China Hubei Province. Instead of using the SARS dataset claimed in midterm report, we find that Covid-19 dataset in China is complete. \\

Now, we would like to discuss how we fit the covid-19 data. We collect the dataset from ... in first 76 days. The covid-19 was controlled in China in around 76 days and building the specialized hospital helped the government to collect severe patients so that the transmission of covid-19 was controlled. We divide the process of simulation in two parts. 

\section{Modelling the usage of mask}
\subsection{Modified SIR model with mask}
In this section, we study the effectiveness of mask in the spreading of the novel COVID-19 disease and develop a variation of the susceptible-infected-removed (SIR) model that provides a theoretical framework to investigate its spread within a community. More specifically, we will investigate how the usage of mask will influence the percentage of deaths and hospitalizations with respect to different infectious contact rate.The model is based on the paper "To mask or not to mask: Modeling the potential for face mask use by the general public to curtail the COVID-19 pandemic" by Steffen E. Eikenberry et al. In this model, we will introduce seven variables. S(t), E(t), I(t), H(t), A(t), R(t) each denote susceptible, exposed, symptomatic infectious, hospitalized, asymptomatic infectious, and recovered classes, with an assumption that people progress from \\
$$S \rightarrow E \rightarrow A \rightarrow I \rightarrow H. $$ \\
At each state, infectious people will be able to recover, and only people in severe condition will go to hospital and may die. D(t) is also included to track cumulative deaths. Two sets of ODE equations will be used during simulation to find how use of mask will impact the spread of disease. We first consider a baseline model for the case where no masks are used. In the second set of ODEs, we will introduce more variables
$S_{U}(t)$, $E_{U}(t)$, $I_{U}(t)$, $H_{U}(t)$, $A_{U}(t)$, $R_{U}(t)$, $S_{M}(t)$, $E_{M}(t)$, $I_{M}(t)$, $H_{M}(t)$, $A_{M}(t)$, $R_{M}(t)$ to divide the population in two part: the population wearing masks and the one not wearing masks.
Here are the two sets of ODEs:\\

\begin{minipage}{0.45\textwidth}
\begin{eqnarray}
  \frac{dS}{dt} &=& -\beta{(t)}(I+\eta A)\frac{S}{N}\nonumber\\
  \frac{dE}{dt} &=& \beta(t)(I+\eta A)\frac{S}{N}-\sigma{E}\nonumber\\
  \frac{dI}{dt} &=& \alpha\sigma{E}-\phi{I}-\gamma_{I}I\nonumber\\
  \frac{dA}{dt} &=& (1-\alpha)\sigma E-\gamma_{A}A\nonumber\\
  \frac{dH}{dt} &=& \phi I - \sigma H - \gamma_{H}H\nonumber\\
  \frac{dR}{dt} &=& \gamma_{I}{I} + \gamma_{A}{A}+\gamma_{H}{H}\nonumber\\
  \frac{dD}{dt} &=& \sigma H\nonumber\\
\end{eqnarray}
\end{minipage}
\begin{minipage}{0.35\textwidth}
\tiny
\begin{eqnarray}
  \frac{dS_{U}}{dt} &=& -\beta(I_{U}+\eta A_{U})\frac{S_{U}}{N}-\beta((1-\epsilon_{0})I_{M}+(1-\epsilon_{0})\eta A_{M})\frac{S_{U}}{N}\nonumber\\
  \frac{dE_{U}}{dt} &=& \beta(I_{U}+\eta{A}_{U})\frac{S_{U}}{N}+\beta((1-\epsilon_{0})I_{M}+(1-\epsilon_{0})\eta A_{M}))\frac{S_{U}}{N}-\sigma E_{U}\nonumber\\
  \frac{dI_{U}}{dt} &=& \alpha\sigma E_{U}-\phi I_{U} - \gamma_{I}I_{U}\nonumber\\
  \frac{dA_{U}}{dt} &=& (1-\alpha)\sigma E_{U}-\gamma_{A}A_{U}\nonumber\\
  \frac{dH_{U}}{dt} &=& \phi I_{U}-\delta H_{U}-\gamma_{H}H_{U}\nonumber\\
  \frac{dR_{U}}{dt} &=& \gamma_{I}I_{U}+\gamma_{A}A_{U}+\gamma_{H}H_{U}\nonumber\\
  \frac{dD_{U}}{dt} &=& \delta H_{U}\nonumber\\
  \frac{dS_{M}}{dt} &=& -\beta (1-\epsilon_{i})(I_{U}+\eta A_{U})\frac{S_{M}}{N}-\beta(1-\epsilon_{i})((1-\epsilon_{0})I_{M}+(1-\epsilon_{0})\eta A_{M})\frac{S_{M}}{N}\nonumber\\
  \frac{dE_{M}}{dt} &=& \beta(1-\epsilon_{i})(I_{U}+\eta A_{U})\frac{S_{M}}{N}+\beta(1-\epsilon_{i})((1-\epsilon_{0})I_{M}+(1-\epsilon_{0})\eta A_{M})\frac{S_{M}}{N}-\sigma E_{M}\nonumber\\
  \frac{dI_{M}}{dt} &=& \alpha\sigma E_{M}-\phi I_{M}-\gamma_{I} I_{M}\nonumber\\
  \frac{dA_{M}}{dt} &=& (1-\alpha)\sigma E_{M}-\gamma_{A}A_{M}\nonumber\\
  \frac{dH_{M}}{dt} &=& \phi I_{M}-\delta H_{M}-\gamma_{H} H_{M}\nonumber\\
  \frac{dR_{M}}{dt} &=& \gamma_{I}I_{M}+\gamma_{A}A_{M}+\gamma_{H}H_{M}\nonumber\\
  \frac{dD_{M}}{dt} &=& \delta H_{M}\nonumber\\
  \end{eqnarray}
\end{minipage}


\subsection{Implementation}

We ran the simulation and recorded what happened in several days. Here, β is the infectious contact rate, σ is the transition exposed to infectious, η is the infectiousness factor for asymptomatic carrier, α is the fraction of infections that become symptomatic, φ is rate of hospitalization, γA is the recovery rate for asymptomatic, γI is the recovery rate, symptomatic, γH is the recovery rate for hospitalized, σ is the death rate in hospital, ε0 is the outward efficiency of the masks, while εi is the inward efficiency of the masks.
Then we found the default estimated values for all parameters with population masked and not masked from the source [2]. Here, an assumption was made that the inward efficiency and outward efficiency of masks are the same ε0 = ε1. We drew a 2 dimensional phase diagram to show how the efficiency of mask (homemade mask or surgery mask) and the percentage of masked people will influence the hospitalization as well as the total deaths among the population.


\subsection{Results}
---------------[ADD. Figures]

The figures above shows the relative peak hospitalizations and cumulative mortality under simulated epidemics, under either a base  = 0.5 or 1.5 day −1. These results are relative to the case where no masks are used. From the graphs presented, we can observe asymmetry between coverage and efficacy, and increasing the coverage of mederately effective mask is generally more useful than increasing the effectiveness of masks from a starting point of moderate coverage. The result agreed with the one concluded from the paper. Therefore, findings suggest that face mask should be adopted as early and universal as possible, even if most masks are not highly effective.

Yet, there are some limitations in our model. Since we used default values based on the source paper, it may not match with the situation in reality, and can be improved. Further, we assumed the inward and outward efficacy are the same, which might not be true in practice, and the values could be improved with more detailed and carefully designed research and study.



------------ADD directions for further investigation :



\end{document}
